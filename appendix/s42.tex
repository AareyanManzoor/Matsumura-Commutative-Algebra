\documentclass[../main]{subfiles}
\begin{document}

\section{Kunz' Theorems}\label{sec:42}

\newparagraph Let $A$ be a ring, $x_1, \ldots, x_n \in A$ and $I=\sum x_i A$. The elements $x_i$ are said to be \defemph{independent}\index{independent elements} if $\sum a_i x_i=0$ implies all $a_i \in I$, or equivalently, if $I / I^2$ is a free $A/I$-module of rank $n$

This definition is due to C.Lech, \cite{lech1964inequalities}. If $x_1, \ldots, x_n$ form an $A$-regular sequence then they are independent. When $A$ is a regular local ring the converse is also true. More precisely, we have the following theorem of Vasconcelos:
\begin{quote}
    Let $R$ be a Noetherian local ring and $I$ be a proper ideal with finite projective dimension. If $I/I^2$ is free over $R / I$, then $I$ is generated by an $R$-sequence.
\end{quote}
For the proof, see \cite{vasconcelos1967ideal} or \cite[Th. 199]{kaplansky1970commutative}.

The following two lemmas are due to Lech.

\begin{lemma}\label{lem:42.01}
If $y z, x_2, \ldots, x_n$ are independent, then $y, x_2, \ldots, x_n$ are also independent.
\end{lemma}

\begin{proof}
Let \[a_1 y+a_2 x_2+\ldots+a_n x_n=0, \quad a_i \in A.\] Then \[a_1 y z+a_2 y x_2+\ldots+a_n y x_n=0,\] therefore $a_1 \in(y z, x_2, \ldots, x_n)$. Write \[a_1=b y z+c_2 x_2+\ldots+c_n x_n.\] Then \[b y^2 z+(c_2 y+a_2) x_2+\ldots+(c_n y+a_n) x_n=0,\] hence $c_i y+a_i \in(y z, x_2, \ldots, x_n)$ and so $a_i \in(y, x_2, \ldots, x_n)$.
\end{proof} 

\begin{lemma}\label{lem:42.02}
If $f_1, \ldots, f_n$ are independent, if $\length(A /(f_1, \ldots, f_n))$ is finite and if $f_1=gh$, then \[\length(A /(f_1, \ldots, f_n))=\length(A/(g, f_2, \ldots, f_n))+\length(A /(h, f_2, \ldots, f_n)).\]
\end{lemma}

\begin{proof}
If $a g=b_1 f_1+\ldots+b_n f_n$, then $a-b_1 h \in(f_1, \ldots, f_n)$ and so \newline $a \in(h, f_2, \ldots, f_n)$. Hence \[(g, f_2, \ldots, f_n) /(f_1, f_2, \ldots, f_n) \cong A /(h, f_2, \ldots, f_n).\]
\end{proof}

\begin{lemma}\label{lem:42.03}
Let $(A, \ideal m, k)$ be a local ring and $\nu_i>0$ be integers. If $\ideal m=(x_1, \ldots, x_n)$ and if $x_1^{\nu_1}, \ldots, x_n^{\nu_n}$ are independent, then \[\length(A /(x_1^{\nu_1}, \ldots, x_n^{\nu_n}))=\nu_1 \ldots \nu_n.\]
\end{lemma}

\begin{proof}
This is a corollary of the preceding lemmas.
\end{proof}

\newparagraph Let $p$ be a prime number and $q=p^s$, $s>0$. If $A$ is a ring of characteristic $p$, then the map $F: A\longrightarrow A$ defined by $F(x)=x^q$ is a homomorphism called the \defemph{($q$-th) Frobenius map}. Its image $F(A)$ is written $A^q$. (Do not confuse it with the free module of rank $q$, which will not appear in this section.) If $A$ is reduced then $A\longrightarrow A^q$, and $F$ can be identified with the inclusion map $A^q \hookrightarrow A$.

\begin{theorem}[E. Kunz]\label{thm:107}
Let $A$ be a Noetherian local ring of characteristic $p$. Then the following are equivalent: 
\begin{enumerate}[label=(\arabic*)]
    \item $A$ is regular,
    \item $A$ is reduced, and $A$ is flat over $A^q$ for $q=p^s$ for every $s>0$,
    \item $A$ is reduced, and $A$ is flat over $A^q$ for $q=p$ for at least one $s>0$.
\end{enumerate}
\end{theorem}

\begin{proof}\phantom{,}
\begin{implyenumerate}
    \item[$(1)\implies(2)$] Let $\completion{A}$ be the completion of $A$. Then
    \[\begin{tikzcd}
    	{\completion{A}} && {\completion{A}} \\
    	\\
	    A && A
    	\arrow[from=3-3, to=1-3]
    	\arrow[from=3-1, to=1-1]
    	\arrow["F", from=3-1, to=3-3]
    	\arrow["F", from=1-1, to=1-3]
    \end{tikzcd}\]
    is commutative, where $F$ is $x \mapsto x^q$. The map $F: A\longrightarrow A$ is flat if its completion $F: \completion{A}\longrightarrow \completion{A}$ is flat. So we may assume that $A$ is complete. Then $A$ has a coefficient field $k$ and we may assume that $A=k[[x_1, \ldots, x_n]]$. In general if $k' \subset k$ is a field extension then the natural map \newline $k[Y_1, \ldots, Y_n] \longrightarrow k[Y_1, \ldots, Y_n]$ is flat, and by localization and completion (Th.\ref{thm:049} guarantees that flatness of a local homomorphism of Noetherian local rings is preserved by completion) we see that \newline $k'[[Y_1, \ldots, Y_n]]\longrightarrow k[[Y_1, \ldots, Y_n]]$ is flat. Therefore \[A^p=k^p[[X_1^p, \ldots, X_n^p]]\longrightarrow k[[X_1^p, \ldots, X_n^p]]\] is flat, and $A$ is free over $k[[X_1^p, \ldots, X_n^p]]$. Hence $A$ is flat over $A^p$.
    \item[$(3)\implies(1)$] Put $A^q=B$ and let $\ideal m, \ideal n$ denote the maximal ideals of $A, B$. Let $\{x_1, \ldots, x_r\}$ be a minimal basis of $\ideal m$. Since $A \cong B$ by $F$, $\{x_1^q, \ldots, x_r^q\}$ is a minimal basis of $\ideal n$. Put $\ideal nA=I$. Since $A$ is flat over $B$ we have \[(\ideal n/\ideal n^2)\otimes_B A=(\ideal n\otimes_B)/(\ideal n^2\otimes_BA)=\ideal nA/\ideal n^2A=I/I^2,\] and $(\ideal n/\ideal n^2)\otimes_BA$ is a free module of rank $r$ over $A/I$. Therefore $x_1^q,\ldots,x_r^q$ are independent in $A$ in the sense of Lech. By Lemma \ref{lem:42.03} we have \[\length_A(A/(x_1,\ldots,x_r^q))=\length_{\completion{A}}(\completion{A}/(x_1^q,\ldots,x_r^q))=q^r.\] The completion $\completion{A}$ has a coefficient field $k$, and we can write \[\completion{A}=k[[x_1,\ldots,x_r]]=k[[X_1,\dots,X_r]]/\ideal a.\] Putting $R=k[[X_1,\dots,X_r]]$ we have $\length_R(R/(X_1^q,\ldots,X_r^q))=q^r$, which means $\ideal a\subseteq(X_1^q,\ldots,X_r^q)$. Since $F:A^q\longrightarrow A$ is flat, and
    \[\begin{tikzcd}
    	{A^q} && A \\
    	\\
    	{A^{q^2}} && {A^q}
    	\arrow["F", "\sim", from=1-1, to=1-3]
    	\arrow["F", from=3-1, to=3-3]
    	\arrow["F"', from=1-1, to=3-1]
    	\arrow["F"', from=1-3, to=3-3]
    \end{tikzcd}\]
    is commutative, $A^{q^2}\longrightarrow A^q$ is also flat and $F^2: A^{q^2}\longrightarrow A$ is flat. Similarly, $F^{\nu}: A^{q^\nu}\longrightarrow A$ is flat for all $\nu>0$. Then $\ideal a \subseteq \bigcap_\nu(X_1^{q^\nu}, \ldots, X_r^{q^\nu})=(0)$, hence $\completion{A}$ is regular and so $A$ is regular.
\end{implyenumerate}

\end{proof}

\begin{theorem}[E. Kunz]\label{thm:108}
Let $A$ be a Noetherian ring of characteristic $p$. If $A$ is finite over $A^p$ then $A$ is excellent.
\end{theorem}

\begin{proof}
First we note that the finiteness of $A$ over $A^p$ is preserved by localization, by taking homomorphic image and by ring extension of finite type.

To prove that $A$ is J-2, it therefore suffices to show that $\Reg(A)$ is open in $\Spec(A)$ under the additional assumption that $A$ is an integral domain. Let $B=A$, $\, P \in \Spec(A)$. Then $P \in \Reg(A)$ iff $A_P=A \otimes_B B_\ideal p$ is flat over \newline $(A_P)^p=B_\ideal p$, where $\ideal p=P \cap B$. Since $A$ is finite over $B$, $P \in \Reg(A)$ is equivalent to \[P \cap B \in\{\ideal p \in \Spec(B) \mid A_\ideal p=A \otimes_BB_\ideal p\text{ is free over }B_\ideal p\}.\] Since the latter set is open in $\Spec(B)$ and since the map $P\longrightarrow P \cap B$ is a homeomorphism from $\Spec(A)$ onto $\Spec(B)$, $\Reg(A)$ is open in $\Spec(A)$

To prove that $A$ is a $G$-ring we use the criterion of \ref{33.E}. We may assume that $A$ is a local domain, and we have to show that if $Q$ is a prime ideal of the completion $\completion{A}$ such that $Q \cap A=(0)$, then $(\completion{A})_Q$ is regular. Let $K$ be the quotient field of $A$, $\, B=A^p$ and $\ideal q=Q \cap B$. Then $\completion{A}=A \otimes_B \completion{B}$, and $(\completion{A})_Q$ is a local ring of \[K \otimes_A \completion{A}=K \otimes_B \completion{B}=K \otimes_{K^p}\completion{B}.\] Since $K^p$ is a field it is easy to see that $(\completion{A})_Q$ is free over its $p$-th power $(\completion{B})_q$ Hence $(\completion{A})_Q$ is regular.

Lastly we will show that $A$ is universally catenary. Again it is enough to show that $A$ is catenary under the additional assumption that $A$ is a local domain. This will be done in a series of lemmas.
\end{proof}

\begin{lemma}\label{lem:42.04}
Let $A$ be a Noetherian local ring of characteristic $p$ such that $A$ is finite over $A^p$, and let $\completion{A}$ denote its completion. Then $\completion{A}$ is finite over $(\completion{A})^p$, and we have $(\completion{A})^p=\completion{(A^p)}$. Moreover, $\Omega_{\completion{A}}=\Omega_A \otimes_A \completion{A}$.
\end{lemma}

\begin{proof}
Put $B=A^p$. Since $A$ is finite over $B$, $B$ is a subspace of $A$ and $\completion{B}$ is a subring of $\completion{A}$. The topology of $A$ is equal to the topology as a $B$-module, hence $\completion{A}=A \otimes_B \completion{B}$ and so $\completion{A}$ is finite over $\completion{B}$. The Frobenius map $F: A\longrightarrow B$ is a surjective homomorphism, hence its completion $\completion{F}: \completion{A}\longrightarrow \completion{B}$ is also surjective. It coincides with the $p$-th power map on $A$, hence on the whole $\completion{A}$ by continuity. Thus $(\completion{A})^p=\completion{B}$. Since $\Omega_A=\Omega_{A / B}$, we have \[\Omega_{A / B} \otimes_A \completion{A}=\Omega_{A / B} \otimes_B \completion{B}=\Omega_{A \otimes_B \completion{B}/\completion{B}}=\Omega_{\completion{A} / \completion{B}}=\Omega_{\completion{A}}.\]
\end{proof}

\begin{lemma}\label{lem:42.05}
Let $A$ be as above and assume that $A$ is an integral domain. Then $\completion{A}$ is reduced.
\end{lemma}

\begin{proof}
Let $F: A\longrightarrow A$ be the Frobenius map. Since $A$ is reduced, $F$ is injective. The completion map $\completion{F}: \completion{A}\longrightarrow \completion{A}$ is also injective, but $\ideal{F}$ is the Frobenius map of $\completion{A}$. Hence $\completion{A}$ is reduced.
\end{proof}

\begin{lemma}\label{lem:42.06}
Let $A$ be as in Lemma \ref{lem:42.05}, and let $K$, $k$ denote the quotient field and the residue field of $A$, respectively. Then $\rank\Omega_K=\rank \Omega_k+\dim A$.
\end{lemma}

\begin{proof}
Let $P$ be a minimal prime of $\completion{A}$, and put $L=(\completion{A})_P$. Then $L$ is a field by the preceding lemma. We have \[\Omega_L=\Omega_{\completion{A}} \otimes_{\completion{A}} L=\Omega_A \otimes_A L=(\Omega_A \otimes_A K) \otimes_K L,\] hence $\rank \Omega_L=\rank \Omega_K$. Therefore we may replace $A$ by $\completion{A} / P$ and assume that $A$ is a complete local domain. Then $A$ contains a coefficient field $k$. Let $x_1, \ldots, x_n\for{n=\dim A}$ be a system of parameters of $A$, and put $A'=k[[x_1, \ldots, x_n]]$. Then $A$ is finite over $A'$ and if $K'$ is the quotient field of $A'$ we have \newline $\rank\Omega_K=\rank\Omega_{K'}$ by Cartier's equality (or directly:
\[[K: K'^p]=[K: K^p][K^p: K'^p]=[K: K'][K': K'^p],\] and $[K: K']=[K^p: K'^p]$ by the Frobenius isomorphism, hence \newline $[K: K^p]=[K': K'^p]$.) Therefore we may replace $A$ by the formal power series ring $A'=k[[x_1, \ldots, x_n]]$. If $\{a_1, \ldots, a_s\}$ is a $p$-basis of $k$ then $\{a_1, \ldots, a_s, x_1, \ldots, x_n\}$ is a $p$-basis of $A'$. Hence \[\rank \Omega_K=s+n=\rank \Omega_k+\dim A.\]
\end{proof}

\begin{lemma}\label{lem:42.07}
Let $A$ be as in Lemma \ref{lem:42.04}, and let $P, Q \in \Spec(A)$, $\, P \supseteq Q$. Put $\rank\Omega_{\kappa(P)}=\delta(P)$. Then $\Ht(P / Q)=\delta(P)-\delta(Q)$. Consequently, $A$ is catenary.
\end{lemma}

\begin{proof}
Put $R=A_P / Q_P$. Then $\delta(Q)$ and $\delta(P)$ are the quotient field and the residue field of $R$, respectively, and $\dim R=\Ht(P / Q)$. Thus the desired equality is nothing but the preceding lemma (applied to $R$). If $P \supset P' \supset Q$, $\, P' \in \Spec(A)$ then the result just obtained shows \[\Ht(P' / P')+\Ht(P' / Q)=\Ht (P / Q).\] Hence $A$ is catenary.
\end{proof}

\end{document}