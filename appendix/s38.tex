\documentclass[../main]{subfiles}
\begin{document}

\section{\texorpdfstring{$p$}{p}-Basis}\label{sec:38}

\newparagraph
Let $R$ be a ring of characteristic $p > 0$, and let $R^p$ denote the subring $\brc{x^p \mid x \in R}$. Let $S$ be a subring of $R$. A subset $B \in R$ is said to be $p$-independent (in $R$) over $S$ if the monomials $b_1^{e_1}, \dots, b_n^{e_n}$ where $b_1,\dots,b_n$ are distinct elements of $B$ and $0\le e_i < p$, are linearly independent over $R^p\sbr{S}$. When $A$ is a ring of characteristic $p$, a polynomial (or a monomial) $f \in A\sbr{X_1, \dots, X_n}$ is said to be \defemph{reduced}\index{reduced!\indexline polynomial} if it is of degree $< p$ in each variable $X_i$. B is called a \defemph{$p$-basis}\index{p-basis@$p$-basis} of $R$ over $S$ if it is $p$-independent over $S$ and $R^p\sbr{S,B} = R$, i.e. if every element $a$ of $R$ can be written uniquely as a reduced polynomial $a = f(b_1, \dots, b_n)$ in distinct elements $b_i$ of $B$ with coefficients in $R^p\sbr{S}$.

If $B$ is a $p$-basis and $M$ is an $R$-module, then any map $\phi: B \varrightarrow{} M$ is uniquely extended to a derivation $D: R \varrightarrow{} M$ over $S$ by \[D(a) = D(f(b)) = \sum_i \pdv{f}{b_i}\phi(b_i)\] where $a=f(b)$ is the unique representation of $a \in R$ as a reduced polynomial in elements of $B$ with coefficients in $R^p\sbr{S}$. It follows that $\Omega_{R/S}$ is a free $R$-module with basis $\brc{\dd{b}\mid b\in B}$. 

\newparagraph
If $k,k'$ are subfields of a field $K$, the subfield generated by them will be denoted by $kk'$; thus $kk' = k(k') = k'(k)$. Let $K$ be a field of characteristic $p$ and $K'$ be a subfield containing $K^p$. If $\sbr{K:K^p}$ is finite it is a power $p^n$ of $p$; its exponent $n$ is called the \defemph{$p$-degree}\index{p-degree@$p$-degree} of $K/K'$ and will be denoted by $\br{K:K'}_p$. This is equal to the smallest number of generators of $K$ over $K'$, and also equal to the rank of the $K$-module $\Omega_{K/K'}$. 

Let $K$ be a field of characteristic $p$ and $k$ be a subfield. Since \newline $K^p\sbr{k} = K(k) = K^pk$, a subset $B$ of $K$ is $p$-independent over $k$ iff, for every finite subset $B'$ of $B$, we have \[(K^pk(B'):K^p k)_p = \mathrm{Card}(B').\] Also $B$ is a p-basis of $K/k$ iff it is $p$-independent over $k$ and $K^pk(B) =K$. By Zorn's lemma any $p$-independent subset is contained in a $p$-basis. 

\begin{theorem}
\label{thm:086}
    Let $K$ and $k$ be as above, $B$ be a subset of $K$ and let $\dd{B}$ denote the subset $\brc{\dd{b} \mid b \in B}$ in $\Omega_{K/k}$. Then:
    \begin{enumerate}
    \item[(i)] $B$ is $p$-independent over $k$ $\iff$ $\dd{B}$ is linearly indep.$/K$,
    \item[(ii)] $B$ is a $p$-basis of $K/K$ $\iff$ $\dd{B}$ is a basis of $\Omega_{K/k}$ over $K$.
    \end{enumerate}
\end{theorem}
\begin{proof}
    If $B$ is a $p$-basis, we have already seen that $\Omega_{K/k}$ is a free $K$-module with basis $\dd{B}$. If $B$ is a $p$-independent, then there exists a $p$-basis containing $B$, hence $\dd{B}$ is linearly independent over $K$. On the other hand if $B$ is not $p$-independent then there exist b, $b_1, \dots, b_n \in B$ such that $b \in K^pk(b_1, \dots, b_n)$, and then $\dd{b} \in \sum \dd{b}_i$. Therefore if $\dd{B}$ is linearly independent then $B$ is $p$-independent, and there exists a $p$-basis $B'$ containing $B$. If $\dd{B}$ is a basis of $\Omega_{K/k}$ then $B = B'$. 
\end{proof}

\newparagraph
Let $K$ be an arbitrary field and $k$ be a subfield. The $K$-module $\Omega_{K/k}$ is generated over $K$ by $\dd{K}$, therefore there exists a subset $B$ such that \newline $\dd{B} = \brc{\dd{b} \mid b \in B}$ is a basis of $\Omega_{K/k}$. Such a subset $B$ is called a \defemph{differential basis}\index{differential!\indexline basis} of $K/k$. The concept of differential basis coincides with that of $p$-basis in the case of characteristic $p$ as we have just seen. In case $\ch(K) = 0$ it coincides with that of transcendency
basis by the following theorem. 
\begin{theorem}
\label{thm:087}
    Let $K\supset k$ be fields of characteristic 0. Then:
    \begin{enumerate}
    \item[(i)] $B\subset K$ is algebraically dependent over $k$ iff $\dd{B}$ is linearly independent over $K$ in $\Omega_{K/k}$,
    \item[(ii)] $B\subset K$ is a transcendency basis of $K/k$ iff $\dd{B}$ is a linear basis of $\Omega_{K/k}$ over $K$.
\end{enumerate}
\end{theorem}
\begin{proof}
    Similar to the proof of the preceding theorem.
\end{proof}
\begin{partheorem}
\label{thm:088}
    Let $K/k$ be a field extension. Then the following are equivalent:
    \begin{enumerate}
    \item[(1)] $K$ is separable over $k$,
    \item[(2)] for any subfield $k'$ of $k$, the canonical map $\Omega_{k/k'}\otimes_k K\varrightarrow{} \Omega_{k/k'}$ is injective,
    \item[(3)] the canonical map $\Omega_k \otimes_k K \varrightarrow{} \Omega_K$ is injective,
    \item[(4)] any derivation $D$ from $k$ to a $K$-module $M$ can be extended to a derivation $K \longrightarrow M$. 
    \end{enumerate}
\end{partheorem}
\begin{proof}
    It is clear that (2) and (4) are equivalent. But (4) is also equivalent to (3). If $\ch(K) = 0$ then (3) holds by the preceding theorem, so (1), (2), (3) and (4) are all true. If $\ch(K) = p$, (1) is equivalent to \[ K\otimes_k k^{p^{-1}}\simeq Kk^{p^{-1}}\] by MacLane's theorem (p.\pageref{exe:27.01}), or what is the same, to linear disjointness of $K^p$ and $k$ over $k^p$. Therefore, $K$ is separable over $k$ $\iff$ the reduced monomials in the elements of a $p$-basis $B$ of $k/k^p$ are linearly independent over $K^p$ $\iff$ $\dd{B}$ is linearly independent over $K$ in $\Omega_K$ $\iff$ $\Omega_k\otimes K \varrightarrow{} \Omega_K$ is injective. 
\end{proof}
\begin{theorem}
\label{thm:089}
    Let $K$ be a separable extension of a field $k$ of characteristic $p$, and let $B$ be a $p$-basis of $K/k$. Then $B$ is algebraically independent over $k$. 
\end{theorem}
\begin{proof}
    Assume the contrary and suppose $b_1, \dots, b_n \in B$ are algebraically dependent over $k$. Take an algebraic relation \[f(b_1, \dots, b_n) = 0, \; f\in k\sbr{X_1, \dots, X_n}\] of lowest possible degree. Put $\deg f = d$. Write 
    \[f(x) = \sum_{0\le \nu_1, \dots, \nu_n < p} g_{\nu_1, \dots, \nu_n}\br{X^p} X_1^{\nu_1}\dots X_n^{\nu_n},\]
    where $g_{(\nu)}$ are polynomials with coefficients in $k$. Since $b_1, \dots, b_n$ are $p$-independent over $k$, we must have $g_{(\nu)}(b^p)=0$ for all $(\nu)$. By the choice of $f$ this happens only if
    \[f\br{X_1, \dots, X_n} = g_{0, \dots, 0}\br{X_1^p, \dots, X_n^p}.\]
    But then we would have $f(X) = h(X)^p$ with $h \in k^{p^{-1}}$ $\sbr{X_1, \dots, X_n}$. Hence \newline $h(b) = 0$. By MacLane's theorem (p.\pageref{exe:27.01}), however, $K$ and $k^{p^{-1}}$ are linearly disjoint over $k$. The monomials of degree $< d$ in $b_1, \dots, b_n$ are linearly independent over $k$, hence they must be linearly independent over $k^{p^{-1}}$ also. This is a contradiction. 
\end{proof}

\newparagraph
We defined formal smoothness (p.\pageref{def:28.formally smooth}) by the condition of liftability (FS). If we further require that the lifting $\nu'$ of $\nu$ is unique, then we say that $A$ is \defemph{formally etale}\index{formally!\indexline etale} over $k$. Here we are mainly concerned with field extensions, so that we consider only discrete topologies.

Let $K/k$ be an extension of fields. If $\ch(K) = 0$, then ``formally smooth'' and ``separably algebraic'' are the same
thing. If $\ch(K)= p$, however, ``formally etale'' is weaker than ``separably algebraic''. (Consider the case where both $K$ and $k$ are perfect. Then $K$ is formally etale over $k$.) In any case, the following are easily seen to be equivalent: 
\begin{enumerate}
    \item[(1)] $K$ is formally etale over $k$, 
    \item[(2)] $K$ is smooth over $k$ and $\Omega_{K/k}=0$,
    \item[(3)] $\Omega_k\otimes_k K\simeq \Omega_K$,
    \item[(4)] for any subfield $k'$ of $k$, $\Omega_{k/k'}\otimes K\simeq\Omega_{K/k'}$,
    \item[(5)] any derivation from $k$ into a $K$-module $M$ can be uniquely extended to a derivation $K\longrightarrow M$.
\end{enumerate}
\begin{theorem}
\label{thm:090}
    Let $K$ be a separable extension field of a field $k$, and let $B$ be a differential basis of $K/k$. Then $k(B)$ is purely transcendental over $k$ and $K$ is formally etale over $k(B)$. 
\end{theorem}
\begin{proof}
    Immediate from Th.~\ref{thm:087} and Th.~\ref{thm:089}.
\end{proof}

\newparagraph
Let $(A,\ideal{m}, k)$ be a local ring and $k$ be a subfield of $A$ such that $K/k$ is formally etale. In this case we call $k$ a \defemph{quasi-coefficient field}\index{quasi-coefficient field}\index{coefficient!quasi \indexline field} of $A$. 

\begin{theorem}
\label{thm:091}
    Every local ring containing a field contains quasi-coefficient fields. If $k$ is a quasi-coefficient field of a local ring $A$, then the completion $A^\ast$ of $A$ contains a unique coefficient field $K$ containing $k$. 
\end{theorem}
\begin{proof}
    If $(A,\ideal{m},k)$ is a local ring and $k_0$ is a perfect field (e.g. the prime field) contained in $A$, then let $B$ be a differential basis of $K$ over $k_0$ and choose a representative $x_i$ in $A$ for each $b_i \in B$. Since $B$ is algebraically independent over $k_0$ by Th.~\ref{thm:089}, $A$ contains the quotient field $k'$ of $k_0\sbr{\brc{x_i}}$, and $k' \simeq k_0(B)$. Then $K$ is formally etale over $k'$. By the definition of formal etaleness, the identity map $K \varrightarrow{} A/\ideal{m}$ can be uniquely lifted to a homomorphism $K \varrightarrow{} \displaystyle\lim_{\longleftarrow} A/\ideal{m}^\nu = A^\ast$ over $k'$, which proves the second half of the theorem. 
\end{proof}

One can define ``quasi-coefficient rings''\index{quasi-coefficient ring}\index{coefficient!quasi \indexline ring} in the unequal characteristic case as follows: a subring $I$ of a local ring $(A,\ideal{m},K)$ with $\ch(K) = p$ is a quasi-coefficient ring of $A$ if
\begin{enumerate}[label = (\arabic*)]
    \item $I$ is a Noetherian local ring with $\rad(I) = pI$, and
    \item $K$ is formally etale over $I/pI$. One can prove that any local ring of unequal characteristic has quasi-coefficient rings. Cf. \cite{matsumuranagoya1977}. 
\end{enumerate}

\newparagraph
Not much is known about $p$-bases for rings. If $k$ is a field of characteristic $p$ and $A$ is a reduced local ring containing $k$, and if $A$ has a $p$-basis over $A^p$, then $A$ must be regular by a theorem of Kunz which will be discussed later. If $A$ is a regular local ring essentially of finite type over $k$, then $A$ has a $p$-basis over $A^p$ (cf. \cite{kimurani1980regular}). The following interesting conjecture of Kunz (1975) is still open in the general case.
\begin{conjecture*}%[Kunz, 1975]
    Let $R$ be a regular local ring of characteristic $p$ and $S$ be a regular subring of $R$ over which $R$ is finite. Does $R$ have a $p$-basis over $S$?\footnote{\textbf{Editor's note:} Matsumura has omitted the assumption that $S\subset R^p$ by mistake. Furthermore, this conjecture was resolved in the affirmative by Kimura and Niitsuma in \cite{kimuraniitsuma1982}.}
\end{conjecture*}
The answer is yes if $p=2$ or 3 (proof is easy). If $\dim R = 2$ there is a geometric proof by Rudakov-Shafarevich \cite{rudakovshafarevich1976}.

The following proposition is a converse of \ref{38.A} in the case of Noetherian local rings.
\begin{proposition}
\label{prop:38.01}
    Let $(R,\ideal{m}_R)$ be a Noetherian local ring of characteristic $p$, and $S$ be a subring of $R$ containing $R^p$ such that $R$ is finite over $S$. Put $\ideal{m}_S = \ideal{m}_R\cap S$, $K = R/\ideal{m}_R$, and $K' = S/\ideal{m}_S$. If $\Omega_{R/S}$ is a free $R$-module with $\dd{x_1}, \dots, \dd{x_r}\for{x_i \in R}$ as a basis, then $x_1, \dots, x_r$ form a $p$-basis of $R$ over $S$. 
\end{proposition}
\begin{proof}
    First we consider the case $\Omega_{R/S} = 0$. Suppose \newline $K \neq K'$. Then, since $K' \supseteq K^p$, there would exist $0 \neq \overline{D}\in \Der_{K'}(K)$, and composing it with the natural homomorphism $R \varrightarrow{} K$ we would have a derivation $0 \neq D \in \Der_{K'}(R,K)$. Therefore $K = K'$, i.e., $R = S+\ideal{m}_R$. Then \[R/\br{\ideal{m}_S R + \ideal{m}_R^2}=K+ \ideal{m}_R/\br{\ideal{m}_S R + \ideal{m}_R^2}\] and the right-hand side is a direct sum. Let $p_2$ denote the projection onto the second summand. Then the composition \[R\varrightarrow{} R/\br{\ideal{m}_S R + \ideal{m}^2_R} \varrightarrow[]{p_2} \ideal{m}_R/\br{\ideal{m}_S R + \ideal{m}^2_R}\] is a derivation of $R$ over $S$, which must be zero. Therefore $\ideal{m}_R=\ideal{m}_S R + \ideal{m}_R^2$ and by \hyperref[NAK]{NAK} we have $\ideal{m}_R = \ideal{m}_S R$. Therefore $R=S + \ideal{m}_S R$, hence $R=S$ by \hyperref[NAK]{NAK}. 

    In the general case put $T=S\sbr{x_1, \dots, x_r}$. If $x_1, \dots, x_r$ are not $p$-independent over $S$, take a reduced polynomial $f\br{X_1, \dots, X_r}\in S[X]$ of lowest degree such that $f\br{x_1, \dots, x_r}=0$. Then $\sum \br{\partial{f}/\partial{x_i}}\dd{x_i}=0$ in $\Omega_{R/S}$, contradiction. Thus $x_1, \dots, x_r$ is a $p$-basis of $T$ over $S$ and $\Omega_{R/S}$ is a free $T$-module with $\dd{x_i}$ as basis, so that $\Omega_{T/S}\otimes_T R \simeq \Omega_{R/S}$. Then $\Omega_{R/T}=0$, and so $R = T$ by what we have already seen. 
\end{proof}

\begin{remark*}
    In connection with the above proof, it is worthwhile to note the following more general result of Berger and Kunz. Let $(R, \ideal{m}, K)$ be a local ring, $S$ a subring of $R$, $\ideal{n}=\ideal{m}\cap S$, $k = S/\ideal{m}$. If $K/k$ is separable then the following sequence is exact: \[0\longrightarrow \ideal{m}/\br{\ideal{n}R+\ideal{m}^2}\longrightarrow \Omega_{K/k}\longrightarrow 0.\] If $\ch(R) = p$ then put $\ideal{n}' = \ideal{m}\cap R^p\sbr{S}$. Then the following sequence is exact: \[0\longrightarrow \ideal{m}/\br{\ideal{n}' R + \ideal{m}^2}\longrightarrow \Omega_{R/S}\otimes K\longrightarrow \Omega_{K/k}\longrightarrow 0.\] For the proof, cf. \cite{bergerkunz1961}.
\end{remark*}
\end{document}